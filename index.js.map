{"version":3,"file":"index.js","sources":["../src/js/render-functions.js","../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["export const createGalleryCardTemplate = ({ tags: alt, webformatURL: src, largeImageURL: href, likes, views, comments, downloads}) => {\n    return `\n      <li>\n      <a class=\"gallery-item\" href=\"${href}\">\n      <img class=\"gallery-image\" src=\"${src}\" alt=\"${alt}\" title=\"${alt}\"/>\n      <div class=\"gallery-text-block\">\n      <p class=\"gallery-text\">Likes<br>${likes}</p>\n      <p class=\"gallery-text\">Views<br>${views}</p>\n      <p class=\"gallery-text\">Comments<br>${comments}</p>\n      <p class=\"gallery-text\">Downloads<br>${downloads}</p>\n      </div>\n      </a>\n      </li>\n    `;\n};","import axios from 'axios';\n\naxios.defaults.baseURL = 'https://pixabay.com/api/';\n\nexport const fetchPhotosByQuery = async (searchedQuery, currentPage) => {\n    const requestParams = new URLSearchParams({\n        q: searchedQuery,\n        per_page: 15,\n        page: currentPage,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n        key: '50720550-abdb0a32f459975af0b381b86',\n    });\n\n    const response = await axios.get('', { params: requestParams });\n    return response.data;\n};","import { createGalleryCardTemplate } from './js/render-functions';\nimport { fetchPhotosByQuery } from './js/pixabay-api';\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nconst refs = {\n    searchForm: document.querySelector('.js-search-form'),\n    gallery: document.querySelector('.js-gallery'),\n    loader: document.querySelector('.js-loader'),\n    loadMoreBtn: document.querySelector('.js-load-more'),\n};\n\nlet currentPage = 1;\nlet searchedQuery = '';\nlet totalPages = 0;\n\nconst lightbox = new SimpleLightbox('.js-gallery a');\n\nconst onSearchFormSubmit = async event => {\n    try {\n        event.preventDefault();\n        const { target: searchForm } = event;\n        searchedQuery = searchForm.elements.user_query.value.trim();\n\n        if (!searchedQuery) {\n            return;\n        }\n\n        currentPage = 1;\n        refs.loader.classList.add('active');\n        refs.gallery.innerHTML = '';\n        refs.loadMoreBtn.classList.add('is-hidden');\n        refs.loadMoreBtn.removeEventListener('click', onLoadMoreBtnClick);\n\n        const data = await fetchPhotosByQuery(searchedQuery, currentPage);\n        refs.loader.classList.remove('active');\n\n        if (data.totalHits === 0 || data.hits.length === 0) {\n            iziToast.error({\n                title: 'Error',\n                message: 'Sorry, there are no images matching your search query. Please try again!',\n            });\n            refs.gallery.innerHTML = '';\n            return;\n        }\n\n        totalPages = Math.ceil(data.totalHits / 15);\n\n        const galleryCardsTemplate = data.hits\n            .map(pictureInfo => createGalleryCardTemplate(pictureInfo))\n            .join('');\n\n        refs.gallery.innerHTML = galleryCardsTemplate;\n\n        lightbox.refresh();\n\n        if (currentPage < totalPages) {\n            refs.loadMoreBtn.classList.remove('is-hidden');\n            refs.loadMoreBtn.addEventListener('click', onLoadMoreBtnClick);\n        } else {\n            iziToast.info({\n                title: 'Info',\n                message: \"We're sorry, but you've reached the end of search results.\",\n            });\n        }\n    } catch (err) {\n        console.log(err);\n    }\n};\n\nrefs.searchForm.addEventListener('submit', onSearchFormSubmit);\n\nconst onLoadMoreBtnClick = async () => {\n    try {\n        currentPage++;\n\n        const data = await fetchPhotosByQuery(searchedQuery, currentPage);\n\n        const galleryCardsTemplate = data.hits\n            .map(pictureInfo => createGalleryCardTemplate(pictureInfo))\n            .join('');\n\n        refs.gallery.insertAdjacentHTML('beforeend', galleryCardsTemplate);\n\n        lightbox.refresh();\n        const { height: cardHeight } = document.querySelector('.js-gallery li').getBoundingClientRect();\n        window.scrollBy({\n            top: cardHeight * 2,\n            behavior: 'smooth',\n        });\n\n        if (currentPage >= totalPages) {\n            refs.loadMoreBtn.classList.add('is-hidden');\n            refs.loadMoreBtn.removeEventListener('click', onLoadMoreBtnClick);\n            iziToast.info({\n                title: 'Info',\n                message: \"We're sorry, but you've reached the end of search results.\",\n            });\n        }\n    } catch (err) {\n        console.log(err);\n    }\n};"],"names":["createGalleryCardTemplate","alt","src","href","likes","views","comments","downloads","axios","fetchPhotosByQuery","searchedQuery","currentPage","requestParams","refs","totalPages","lightbox","SimpleLightbox","onSearchFormSubmit","event","searchForm","onLoadMoreBtnClick","data","iziToast","galleryCardsTemplate","pictureInfo","err","cardHeight"],"mappings":"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"}